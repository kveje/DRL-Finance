2025-04-17 15:41:52 - setup_logging - utils\setup_logging.py:54 - INFO - Logging system initialized
2025-04-17 15:41:52 - setup_logging - utils\setup_logging.py:58 - INFO - Experiment logs will be saved to: experiments\experiment_20250417_154152
2025-04-17 15:41:52 - setup_logging - utils\setup_logging.py:68 - INFO - Log file: setup_experiment_20250417_154152.log
2025-04-17 15:41:52 - setup_logging - scripts\setup_experiment.py:81 - INFO - Setting up experiment: experiment_20250417_154152
2025-04-17 15:41:52 - setup_logging - scripts\setup_experiment.py:82 - INFO - Using assets: ['AXP', 'AMGN', 'AAPL', 'BA', 'CAT', 'CSCO', 'CVX', 'GS', 'HD', 'HON', 'IBM', 'INTC', 'JNJ', 'KO', 'JPM', 'MCD', 'MMM', 'MRK', 'MSFT', 'NKE', 'PG', 'TRV', 'UNH', 'CRM', 'VZ', 'V', 'WBA', 'WMT', 'DIS']
2025-04-17 15:41:52 - setup_logging - scripts\setup_experiment.py:83 - INFO - Training period: 2016-04-01 to 2022-03-31
2025-04-17 15:41:52 - setup_logging - scripts\setup_experiment.py:84 - INFO - Validation period: 2022-04-01 to 2023-03-31
2025-04-17 15:41:52 - data_manager - data\data_manager.py:102 - INFO - Data manager initialized
2025-04-17 15:41:52 - data_manager - data\data_manager.py:103 - INFO -   Raw data directory: data/raw
2025-04-17 15:41:52 - data_manager - data\data_manager.py:104 - INFO -   Processed data directory: data/processed
2025-04-17 15:41:52 - data_manager - data\data_manager.py:105 - INFO -   Normalized data directory: data/normalized
2025-04-17 15:41:52 - data_manager - data\data_manager.py:106 - INFO -   Use saved data: True
2025-04-17 15:41:52 - data_manager - data\data_manager.py:107 - INFO -   Save raw data: True
2025-04-17 15:41:52 - data_manager - data\data_manager.py:108 - INFO -   Save processed data: True
2025-04-17 15:41:52 - data_manager - data\data_manager.py:109 - INFO -   Save normalized data: True
2025-04-17 15:41:52 - data_manager - data\data_manager.py:110 - INFO -   Available sources: ['yahoo']
2025-04-17 15:41:52 - data_manager - data\data_manager.py:111 - INFO -   Available processors: ['technical_indicator', 'turbulence', 'vix']
2025-04-17 15:41:52 - setup_logging - scripts\setup_experiment.py:98 - INFO - Downloading data...
2025-04-17 15:41:52 - data_manager - data\data_manager.py:160 - INFO - Set current file base to: yahoo_AAPL-AMGN-AXP-BA-CAT-CRM-CSCO-CVX-DIS-GS-HD-HON-IBM-INTC-JNJ-JPM-KO-MCD-MMM-MRK-MSFT-NKE-PG-TRV-UNH-V-VZ-WBA-WMT_2016-04-01_2023-03-31_1d
2025-04-17 15:41:52 - data_manager - data\data_manager.py:212 - INFO - Loading saved raw data from data/raw\yahoo_AAPL-AMGN-AXP-BA-CAT-CRM-CSCO-CVX-DIS-GS-HD-HON-IBM-INTC-JNJ-JPM-KO-MCD-MMM-MRK-MSFT-NKE-PG-TRV-UNH-V-VZ-WBA-WMT_2016-04-01_2023-03-31_1d_raw.csv
2025-04-17 15:41:52 - setup_logging - scripts\setup_experiment.py:110 - INFO - Processing data with technical indicators...
2025-04-17 15:41:52 - data_manager - data\data_manager.py:280 - INFO - Applying processor: technical_indicator
2025-04-17 15:41:52 - technical_indicator - data\processors\technical_indicator.py:105 - WARNING - Unknown indicators requested: ['bb']
2025-04-17 15:41:52 - technical_indicator - data\processors\technical_indicator.py:112 - INFO - Calculating indicators: ['rsi', 'macd', 'atr', 'obv', 'adx', 'cci', 'stoch', 'linreg']
2025-04-17 15:42:03 - data_manager - data\data_manager.py:280 - INFO - Applying processor: vix
2025-04-17 15:42:03 - yahoo - data\sources\yahoo.py:89 - INFO - Downloaded data for 1 tickers from 2016-04-01 to 2023-03-30
2025-04-17 15:42:03 - data_manager - data\data_manager.py:317 - INFO - Saving processed data to: data/processed\yahoo_AAPL-AMGN-AXP-BA-CAT-CRM-CSCO-CVX-DIS-GS-HD-HON-IBM-INTC-JNJ-JPM-KO-MCD-MMM-MRK-MSFT-NKE-PG-TRV-UNH-V-VZ-WBA-WMT_2016-04-01_2023-03-31_1d_processed.csv
2025-04-17 15:42:04 - setup_logging - scripts\setup_experiment.py:119 - INFO - Normalizing data...
2025-04-17 15:42:04 - data_manager - data\data_manager.py:364 - INFO - Auto-generating feature groups from columns
2025-04-17 15:42:04 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to price features: ['open', 'high', 'low', 'close']
2025-04-17 15:42:04 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to volume features: ['volume']
2025-04-17 15:42:04 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to market features: ['vix']
2025-04-17 15:42:04 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to trend features: ['macd_line_12_26', 'macd_signal_9', 'macd_hist_12_26_9']
2025-04-17 15:42:04 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to momentum features: ['rsi_14', 'cci_20', 'stoch_k_14', 'stoch_d_14_3']
2025-04-17 15:42:04 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to volatility features: ['atr_14', 'adx_14', 'pdi_14', 'ndi_14']
2025-04-17 15:42:05 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to volume_indicators features: ['obv']
2025-04-17 15:42:05 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to other features: ['linreg_slope_10', 'linreg_intercept_10', 'linreg_r2_10', 'linreg_slope_pvalue_10']
2025-04-17 15:42:05 - data_manager - data\data_manager.py:409 - INFO - Saving normalized data to: data/normalized\yahoo_AAPL-AMGN-AXP-BA-CAT-CRM-CSCO-CVX-DIS-GS-HD-HON-IBM-INTC-JNJ-JPM-KO-MCD-MMM-MRK-MSFT-NKE-PG-TRV-UNH-V-VZ-WBA-WMT_2016-04-01_2023-03-31_1d_normalized_percentage.csv
2025-04-17 15:42:05 - setup_logging - scripts\setup_experiment.py:129 - INFO - Splitting data into training and validation sets...
2025-04-17 15:42:05 - data_manager - data\data_manager.py:634 - WARNING - Test end date 2023-03-31 00:00:00 is after the latest available date 2023-03-30 00:00:00. Using 2023-03-30 00:00:00 instead.
2025-04-17 15:42:05 - data_manager - data\data_manager.py:709 - INFO - Resetting day indices for each split to start from 1
2025-04-17 15:42:05 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 0-1511 to 1-1512
2025-04-17 15:42:05 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 1512-1761 to 1-250
2025-04-17 15:42:05 - data_manager - data\data_manager.py:742 - INFO - Data split: Training: 43848 rows, Test: 7250 rows
2025-04-17 15:42:05 - data_manager - data\data_manager.py:634 - WARNING - Test end date 2023-03-31 00:00:00 is after the latest available date 2023-03-30 00:00:00. Using 2023-03-30 00:00:00 instead.
2025-04-17 15:42:05 - data_manager - data\data_manager.py:709 - INFO - Resetting day indices for each split to start from 1
2025-04-17 15:42:05 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 0-1511 to 1-1512
2025-04-17 15:42:05 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 1512-1761 to 1-250
2025-04-17 15:42:05 - data_manager - data\data_manager.py:742 - INFO - Data split: Training: 43848 rows, Test: 7250 rows
2025-04-17 15:42:05 - setup_logging - scripts\setup_experiment.py:188 - INFO - Saving data...
2025-04-17 15:42:06 - setup_logging - scripts\setup_experiment.py:229 - INFO - Creating training and validation environments...
2025-04-17 15:42:06 - trading_env - environments\trading_env.py:52 - INFO - Initializing TradingEnv
2025-04-17 15:42:06 - trading_env - environments\trading_env.py:482 - INFO - Environment initialized with 29 assets
2025-04-17 15:42:06 - trading_env - environments\trading_env.py:483 - INFO - Initial balance: $100000.00
2025-04-17 15:42:06 - trading_env - environments\trading_env.py:484 - INFO - Window size: 10
2025-04-17 15:42:06 - trading_env - environments\trading_env.py:485 - INFO - Data length: 43848
2025-04-17 15:42:06 - trading_env - environments\trading_env.py:486 - INFO - Number of stocks: 29
2025-04-17 15:42:06 - trading_env - environments\trading_env.py:487 - INFO - Action space: Box(-2147483646, 2147483645, (29,), int32)
2025-04-17 15:42:06 - trading_env - environments\trading_env.py:477 - INFO - Random seed set to 190378
2025-04-17 15:42:06 - trading_env - environments\trading_env.py:52 - INFO - Initializing TradingEnv
2025-04-17 15:42:06 - trading_env - environments\trading_env.py:482 - INFO - Environment initialized with 29 assets
2025-04-17 15:42:06 - trading_env - environments\trading_env.py:483 - INFO - Initial balance: $100000.00
2025-04-17 15:42:06 - trading_env - environments\trading_env.py:484 - INFO - Window size: 10
2025-04-17 15:42:06 - trading_env - environments\trading_env.py:485 - INFO - Data length: 7250
2025-04-17 15:42:06 - trading_env - environments\trading_env.py:486 - INFO - Number of stocks: 29
2025-04-17 15:42:06 - trading_env - environments\trading_env.py:487 - INFO - Action space: Box(-2147483646, 2147483645, (29,), int32)
2025-04-17 15:42:06 - trading_env - environments\trading_env.py:477 - INFO - Random seed set to 892445
2025-04-17 15:42:06 - setup_logging - scripts\setup_experiment.py:296 - INFO - Initializing DirectionalDQNAgent...
2025-04-17 15:42:06 - directional_dqn_agent - models\agents\directional_dqn_agent.py:64 - INFO - DirectionalDQN Network architecture: DirectionalDQNNetwork(
  (activation): ReLU()
  (layers): ModuleList(
    (0): Linear(in_features=6411, out_features=1024, bias=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): ReLU()
    (3): Linear(in_features=512, out_features=256, bias=True)
    (4): ReLU()
    (5): Linear(in_features=256, out_features=128, bias=True)
    (6): ReLU()
    (7): Linear(in_features=128, out_features=64, bias=True)
    (8): ReLU()
    (9): Linear(in_features=64, out_features=32, bias=True)
    (10): ReLU()
  )
  (direction_head): DirectionHead(
    (linear): Linear(in_features=32, out_features=87, bias=True)
  )
)
2025-04-17 15:42:07 - directional_dqn_agent - models\agents\directional_dqn_agent.py:64 - INFO - DirectionalDQN Network architecture: DirectionalDQNNetwork(
  (activation): ReLU()
  (layers): ModuleList(
    (0): Linear(in_features=6411, out_features=1024, bias=True)
    (1): Linear(in_features=1024, out_features=512, bias=True)
    (2): ReLU()
    (3): Linear(in_features=512, out_features=256, bias=True)
    (4): ReLU()
    (5): Linear(in_features=256, out_features=128, bias=True)
    (6): ReLU()
    (7): Linear(in_features=128, out_features=64, bias=True)
    (8): ReLU()
    (9): Linear(in_features=64, out_features=32, bias=True)
    (10): ReLU()
  )
  (direction_head): DirectionHead(
    (linear): Linear(in_features=32, out_features=87, bias=True)
  )
)
2025-04-17 15:42:07 - setup_logging - scripts\setup_experiment.py:392 - INFO - Setting up experiment manager...
2025-04-17 15:42:07 - experiment_experiment_20250417_154152 - models\experiment_manager.py:200 - INFO - Saved experiment configuration to experiments\experiment_20250417_154152\config
2025-04-17 15:42:07 - experiment_experiment_20250417_154152 - models\experiment_manager.py:241 - INFO - Saved data information to experiments\experiment_20250417_154152\data
2025-04-17 15:42:07 - experiment_experiment_20250417_154152 - models\experiment_manager.py:155 - INFO - Initialized experiment: experiment_20250417_154152
2025-04-17 15:42:07 - setup_logging - scripts\setup_experiment.py:412 - INFO - Saving experiment manager for later training...
2025-04-17 15:42:07 - setup_logging - scripts\setup_experiment.py:412 - INFO - Saving experiment manager for later training...
2025-04-17 15:42:07 - setup_logging - scripts\setup_experiment.py:416 - INFO - Experiment setup completed: experiment_20250417_154152
2025-04-17 15:42:07 - setup_logging - scripts\setup_experiment.py:416 - INFO - Experiment setup completed: experiment_20250417_154152
2025-04-17 15:42:08 - setup_logging - scripts\setup_experiment.py:417 - INFO - All required files have been saved to experiments\experiment_20250417_154152
2025-04-17 15:42:08 - setup_logging - scripts\setup_experiment.py:417 - INFO - All required files have been saved to experiments\experiment_20250417_154152
2025-04-17 15:42:08 - setup_logging - scripts\setup_experiment.py:418 - INFO - The experiment is ready to be trained with:
2025-04-17 15:42:08 - setup_logging - scripts\setup_experiment.py:418 - INFO - The experiment is ready to be trained with:
2025-04-17 15:42:08 - setup_logging - scripts\setup_experiment.py:419 - INFO -   python -m scripts.train_experiment --experiment-name experiment_20250417_154152
2025-04-17 15:42:08 - setup_logging - scripts\setup_experiment.py:419 - INFO -   python -m scripts.train_experiment --experiment-name experiment_20250417_154152
2025-04-17 15:42:08 - setup_logging - scripts\setup_experiment.py:420 - INFO - To continue training from a checkpoint later, use:
2025-04-17 15:42:08 - setup_logging - scripts\setup_experiment.py:420 - INFO - To continue training from a checkpoint later, use:
2025-04-17 15:42:08 - setup_logging - scripts\setup_experiment.py:421 - INFO -   python -m scripts.continue_experiment --experiment-name experiment_20250417_154152
2025-04-17 15:42:08 - setup_logging - scripts\setup_experiment.py:421 - INFO -   python -m scripts.continue_experiment --experiment-name experiment_20250417_154152
