2025-04-23 07:03:34 - setup_logging - utils\setup_logging.py:54 - INFO - Logging system initialized
2025-04-23 07:03:34 - setup_logging - utils\setup_logging.py:58 - INFO - Experiment logs will be saved to: experiments\A2C-percentage
2025-04-23 07:03:34 - setup_logging - utils\setup_logging.py:68 - INFO - Log file: setup_A2C-percentage.log
2025-04-23 07:03:34 - setup_logging - scripts\setup_experiment.py:86 - INFO - Setting up experiment: A2C-percentage
2025-04-23 07:03:34 - setup_logging - scripts\setup_experiment.py:87 - INFO - Using assets: ['AXP', 'AMGN', 'AAPL', 'BA', 'CAT', 'CSCO', 'CVX', 'GS', 'HD', 'HON', 'IBM', 'INTC', 'JNJ', 'KO', 'JPM', 'MCD', 'MMM', 'MRK', 'MSFT', 'NKE', 'PG', 'TRV', 'UNH', 'CRM', 'VZ', 'V', 'WBA', 'WMT', 'DIS']
2025-04-23 07:03:34 - setup_logging - scripts\setup_experiment.py:88 - INFO - Training period: 2016-04-01 to 2022-03-31
2025-04-23 07:03:34 - setup_logging - scripts\setup_experiment.py:89 - INFO - Validation period: 2022-04-01 to 2023-03-31
2025-04-23 07:03:34 - data_manager - data\data_manager.py:102 - INFO - Data manager initialized
2025-04-23 07:03:34 - data_manager - data\data_manager.py:103 - INFO -   Raw data directory: data/raw
2025-04-23 07:03:34 - data_manager - data\data_manager.py:104 - INFO -   Processed data directory: data/processed
2025-04-23 07:03:34 - data_manager - data\data_manager.py:105 - INFO -   Normalized data directory: data/normalized
2025-04-23 07:03:34 - data_manager - data\data_manager.py:106 - INFO -   Use saved data: True
2025-04-23 07:03:34 - data_manager - data\data_manager.py:107 - INFO -   Save raw data: True
2025-04-23 07:03:34 - data_manager - data\data_manager.py:108 - INFO -   Save processed data: True
2025-04-23 07:03:34 - data_manager - data\data_manager.py:109 - INFO -   Save normalized data: True
2025-04-23 07:03:34 - data_manager - data\data_manager.py:110 - INFO -   Available sources: ['yahoo']
2025-04-23 07:03:34 - data_manager - data\data_manager.py:111 - INFO -   Available processors: ['technical_indicator', 'turbulence', 'vix']
2025-04-23 07:03:34 - setup_logging - scripts\setup_experiment.py:103 - INFO - Downloading data...
2025-04-23 07:03:34 - data_manager - data\data_manager.py:160 - INFO - Set current file base to: yahoo_AAPL-AMGN-AXP-BA-CAT-CRM-CSCO-CVX-DIS-GS-HD-HON-IBM-INTC-JNJ-JPM-KO-MCD-MMM-MRK-MSFT-NKE-PG-TRV-UNH-V-VZ-WBA-WMT_2016-04-01_2023-03-31_1d
2025-04-23 07:03:34 - data_manager - data\data_manager.py:212 - INFO - Loading saved raw data from data/raw\yahoo_AAPL-AMGN-AXP-BA-CAT-CRM-CSCO-CVX-DIS-GS-HD-HON-IBM-INTC-JNJ-JPM-KO-MCD-MMM-MRK-MSFT-NKE-PG-TRV-UNH-V-VZ-WBA-WMT_2016-04-01_2023-03-31_1d_raw.csv
2025-04-23 07:03:34 - setup_logging - scripts\setup_experiment.py:115 - INFO - Processing data with technical indicators...
2025-04-23 07:03:34 - data_manager - data\data_manager.py:280 - INFO - Applying processor: technical_indicator
2025-04-23 07:03:34 - technical_indicator - data\processors\technical_indicator.py:112 - INFO - Calculating indicators: ['sma', 'ema', 'rsi', 'macd', 'bollinger', 'atr', 'obv', 'adx', 'cci', 'stoch', 'mfi', 'roc', 'williams_r', 'vwap', 'ichimoku', 'keltner', 'linreg']
2025-04-23 07:03:44 - data_manager - data\data_manager.py:280 - INFO - Applying processor: vix
2025-04-23 07:03:46 - yahoo - data\sources\yahoo.py:89 - INFO - Downloaded data for 1 tickers from 2016-04-01 to 2023-03-30
2025-04-23 07:03:46 - data_manager - data\data_manager.py:317 - INFO - Saving processed data to: data/processed\yahoo_AAPL-AMGN-AXP-BA-CAT-CRM-CSCO-CVX-DIS-GS-HD-HON-IBM-INTC-JNJ-JPM-KO-MCD-MMM-MRK-MSFT-NKE-PG-TRV-UNH-V-VZ-WBA-WMT_2016-04-01_2023-03-31_1d_processed.csv
2025-04-23 07:03:48 - setup_logging - scripts\setup_experiment.py:124 - INFO - Normalizing data...
2025-04-23 07:03:48 - data_manager - data\data_manager.py:364 - INFO - Auto-generating feature groups from columns
2025-04-23 07:03:48 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to price features: ['open', 'high', 'low', 'close']
2025-04-23 07:03:48 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to volume features: ['volume']
2025-04-23 07:03:48 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to market features: ['vix']
2025-04-23 07:03:48 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to trend features: ['sma_5', 'sma_10', 'sma_20', 'sma_50', 'ema_5', 'ema_10', 'ema_20', 'ema_50', 'macd_line_12_26', 'macd_signal_9', 'macd_hist_12_26_9', 'vwap_daily', 'tenkan_sen_9', 'kijun_sen_26', 'senkou_span_a_26', 'senkou_span_b_52_26', 'chikou_span_26', 'keltner_middle_20', 'keltner_upper_20_10_2', 'keltner_lower_20_10_2']
2025-04-23 07:03:48 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to momentum features: ['rsi_14', 'cci_20', 'stoch_k_14', 'stoch_d_14_3', 'mfi_14', 'roc_12', 'williams_r_14']
2025-04-23 07:03:48 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to volatility features: ['bb_middle_20', 'bb_upper_20', 'bb_lower_20', 'bb_pct_b_20', 'atr_14', 'adx_14', 'pdi_14', 'ndi_14']
2025-04-23 07:03:49 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to volume_indicators features: ['obv']
2025-04-23 07:03:49 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to other features: ['linreg_slope_10', 'linreg_intercept_10', 'linreg_r2_10', 'linreg_slope_pvalue_10']
2025-04-23 07:03:49 - data_manager - data\data_manager.py:409 - INFO - Saving normalized data to: data/normalized\yahoo_AAPL-AMGN-AXP-BA-CAT-CRM-CSCO-CVX-DIS-GS-HD-HON-IBM-INTC-JNJ-JPM-KO-MCD-MMM-MRK-MSFT-NKE-PG-TRV-UNH-V-VZ-WBA-WMT_2016-04-01_2023-03-31_1d_normalized_percentage.csv
2025-04-23 07:03:50 - setup_logging - scripts\setup_experiment.py:134 - INFO - Splitting data into training and validation sets...
2025-04-23 07:03:50 - data_manager - data\data_manager.py:634 - WARNING - Test end date 2023-03-31 00:00:00 is after the latest available date 2023-03-30 00:00:00. Using 2023-03-30 00:00:00 instead.
2025-04-23 07:03:50 - data_manager - data\data_manager.py:709 - INFO - Resetting day indices for each split to start from 1
2025-04-23 07:03:50 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 0-1511 to 1-1512
2025-04-23 07:03:50 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 1512-1761 to 1-250
2025-04-23 07:03:50 - data_manager - data\data_manager.py:742 - INFO - Data split: Training: 43848 rows, Test: 7250 rows
2025-04-23 07:03:50 - data_manager - data\data_manager.py:634 - WARNING - Test end date 2023-03-31 00:00:00 is after the latest available date 2023-03-30 00:00:00. Using 2023-03-30 00:00:00 instead.
2025-04-23 07:03:50 - data_manager - data\data_manager.py:709 - INFO - Resetting day indices for each split to start from 1
2025-04-23 07:03:50 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 0-1511 to 1-1512
2025-04-23 07:03:50 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 1512-1761 to 1-250
2025-04-23 07:03:50 - data_manager - data\data_manager.py:742 - INFO - Data split: Training: 43848 rows, Test: 7250 rows
2025-04-23 07:03:50 - data_manager - data\data_manager.py:634 - WARNING - Test end date 2023-03-31 00:00:00 is after the latest available date 2023-03-30 00:00:00. Using 2023-03-30 00:00:00 instead.
2025-04-23 07:03:50 - data_manager - data\data_manager.py:709 - INFO - Resetting day indices for each split to start from 1
2025-04-23 07:03:50 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 0-1511 to 1-1512
2025-04-23 07:03:50 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 1512-1761 to 1-250
2025-04-23 07:03:50 - data_manager - data\data_manager.py:742 - INFO - Data split: Training: 43848 rows, Test: 7250 rows
2025-04-23 07:03:50 - setup_logging - scripts\setup_experiment.py:178 - INFO - Generating data visualizations...
2025-04-23 07:03:50 - data_visualization - visualization\data_visualization.py:53 - INFO - Visualization tool initialized with output directory: experiments\A2C-percentage\visualizations
2025-04-23 07:03:50 - data_visualization - visualization\data_visualization.py:1393 - INFO - Generating raw data visualizations...
2025-04-23 07:03:52 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:03:52 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:03:53 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:03:53 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:03:53 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\A2C-percentage\visualizations
2025-04-23 07:03:53 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\A2C-percentage\visualizations
2025-04-23 07:03:53 - data_visualization - visualization\data_visualization.py:1455 - INFO - Generating processed data visualizations...
2025-04-23 07:04:08 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:08 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:08 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:09 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:11 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:11 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:11 - data_visualization - visualization\data_visualization.py:1517 - INFO - Generating normalized data visualizations...
2025-04-23 07:04:19 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:20 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:20 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:20 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:22 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:22 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:24 - data_visualization - visualization\data_visualization.py:334 - INFO - Raw vs. normalized comparison saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:24 - data_visualization - visualization\data_visualization.py:1584 - INFO - All visualizations completed and saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:24 - data_visualization - visualization\data_visualization.py:1393 - INFO - Generating raw data visualizations...
2025-04-23 07:04:25 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:25 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:25 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:26 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:26 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:26 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:26 - data_visualization - visualization\data_visualization.py:1455 - INFO - Generating processed data visualizations...
2025-04-23 07:04:32 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:32 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:32 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:32 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:34 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:34 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:34 - data_visualization - visualization\data_visualization.py:1517 - INFO - Generating normalized data visualizations...
2025-04-23 07:04:40 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:40 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:41 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:41 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:42 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:42 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:43 - data_visualization - visualization\data_visualization.py:334 - INFO - Raw vs. normalized comparison saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:43 - data_visualization - visualization\data_visualization.py:1584 - INFO - All visualizations completed and saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:44 - data_visualization - visualization\data_visualization.py:1170 - INFO - Training vs validation comparison saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:44 - setup_logging - scripts\setup_experiment.py:216 - INFO - Data visualizations saved to experiments\A2C-percentage\visualizations
2025-04-23 07:04:44 - setup_logging - scripts\setup_experiment.py:223 - INFO - Saving data...
2025-04-23 07:04:46 - setup_logging - scripts\setup_experiment.py:264 - INFO - Creating training and validation environments...
2025-04-23 07:04:46 - trading_env - environments\trading_env.py:52 - INFO - Initializing TradingEnv
2025-04-23 07:04:46 - trading_env - environments\trading_env.py:496 - INFO - Environment initialized with 29 assets
2025-04-23 07:04:46 - trading_env - environments\trading_env.py:497 - INFO - Initial balance: $100000.00
2025-04-23 07:04:46 - trading_env - environments\trading_env.py:498 - INFO - Window size: 3
2025-04-23 07:04:46 - trading_env - environments\trading_env.py:499 - INFO - Data length: 43848
2025-04-23 07:04:46 - trading_env - environments\trading_env.py:500 - INFO - Number of stocks: 29
2025-04-23 07:04:46 - trading_env - environments\trading_env.py:501 - INFO - Action space: Box(-2147483646, 2147483645, (29,), int32)
2025-04-23 07:04:46 - trading_env - environments\trading_env.py:491 - INFO - Random seed set to 647610
2025-04-23 07:04:46 - trading_env - environments\trading_env.py:52 - INFO - Initializing TradingEnv
2025-04-23 07:04:46 - trading_env - environments\trading_env.py:496 - INFO - Environment initialized with 29 assets
2025-04-23 07:04:46 - trading_env - environments\trading_env.py:497 - INFO - Initial balance: $100000.00
2025-04-23 07:04:46 - trading_env - environments\trading_env.py:498 - INFO - Window size: 3
2025-04-23 07:04:46 - trading_env - environments\trading_env.py:499 - INFO - Data length: 7250
2025-04-23 07:04:46 - trading_env - environments\trading_env.py:500 - INFO - Number of stocks: 29
2025-04-23 07:04:46 - trading_env - environments\trading_env.py:501 - INFO - Action space: Box(-2147483646, 2147483645, (29,), int32)
2025-04-23 07:04:46 - trading_env - environments\trading_env.py:491 - INFO - Random seed set to 418639
2025-04-23 07:04:46 - setup_logging - scripts\setup_experiment.py:331 - INFO - Initializing DirectionalDQNAgent...
2025-04-23 07:04:46 - directional_interpreter - models\action_interpreters\directional_interpreter.py:45 - INFO - Initialized DirectionalActionInterpreter with min_action_scale=0.2
2025-04-23 07:04:46 - directional_interpreter - models\action_interpreters\directional_interpreter.py:46 - INFO - Position limits: min=0, max=100
2025-04-23 07:04:46 - directional_dqn_agent - models\agents\directional_dqn_agent.py:70 - INFO - DirectionalDQN Network architecture: DirectionalDQNNetwork(
  (activation): ReLU()
  (layers): ModuleList(
    (0): Linear(in_features=4091, out_features=256, bias=True)
    (1): Linear(in_features=256, out_features=128, bias=True)
    (2): Dropout(p=0.1, inplace=False)
    (3): ReLU()
    (4): Linear(in_features=128, out_features=64, bias=True)
    (5): Dropout(p=0.1, inplace=False)
    (6): ReLU()
  )
  (direction_head): DirectionHead(
    (linear): Linear(in_features=64, out_features=87, bias=True)
  )
)
2025-04-23 07:04:46 - directional_dqn_agent - models\agents\directional_dqn_agent.py:70 - INFO - DirectionalDQN Network architecture: DirectionalDQNNetwork(
  (activation): ReLU()
  (layers): ModuleList(
    (0): Linear(in_features=4091, out_features=256, bias=True)
    (1): Linear(in_features=256, out_features=128, bias=True)
    (2): Dropout(p=0.1, inplace=False)
    (3): ReLU()
    (4): Linear(in_features=128, out_features=64, bias=True)
    (5): Dropout(p=0.1, inplace=False)
    (6): ReLU()
  )
  (direction_head): DirectionHead(
    (linear): Linear(in_features=64, out_features=87, bias=True)
  )
)
2025-04-23 07:04:47 - setup_logging - scripts\setup_experiment.py:427 - INFO - Setting up experiment manager...
2025-04-23 07:04:47 - experiment_A2C-percentage - models\experiment_manager.py:195 - INFO - Saved experiment configuration to experiments\A2C-percentage\config
2025-04-23 07:04:47 - experiment_A2C-percentage - models\experiment_manager.py:236 - INFO - Saved data information to experiments\A2C-percentage\data
2025-04-23 07:04:47 - experiment_A2C-percentage - models\experiment_manager.py:150 - INFO - Initialized experiment: A2C-percentage
2025-04-23 07:04:47 - setup_logging - scripts\setup_experiment.py:446 - INFO - Saving experiment manager for later training...
2025-04-23 07:04:47 - setup_logging - scripts\setup_experiment.py:446 - INFO - Saving experiment manager for later training...
2025-04-23 07:04:47 - setup_logging - scripts\setup_experiment.py:450 - INFO - Experiment setup completed: A2C-percentage
2025-04-23 07:04:47 - setup_logging - scripts\setup_experiment.py:450 - INFO - Experiment setup completed: A2C-percentage
2025-04-23 07:04:47 - setup_logging - scripts\setup_experiment.py:451 - INFO - All required files have been saved to experiments\A2C-percentage
2025-04-23 07:04:47 - setup_logging - scripts\setup_experiment.py:451 - INFO - All required files have been saved to experiments\A2C-percentage
2025-04-23 07:04:47 - setup_logging - scripts\setup_experiment.py:452 - INFO - The experiment is ready to be trained with:
2025-04-23 07:04:47 - setup_logging - scripts\setup_experiment.py:452 - INFO - The experiment is ready to be trained with:
2025-04-23 07:04:47 - setup_logging - scripts\setup_experiment.py:453 - INFO -   python -m scripts.train_experiment --experiment-name A2C-percentage
2025-04-23 07:04:47 - setup_logging - scripts\setup_experiment.py:453 - INFO -   python -m scripts.train_experiment --experiment-name A2C-percentage
2025-04-23 07:04:47 - setup_logging - scripts\setup_experiment.py:454 - INFO - To continue training from a checkpoint later, use:
2025-04-23 07:04:47 - setup_logging - scripts\setup_experiment.py:454 - INFO - To continue training from a checkpoint later, use:
2025-04-23 07:04:47 - setup_logging - scripts\setup_experiment.py:455 - INFO -   python -m scripts.continue_experiment --experiment-name A2C-percentage
2025-04-23 07:04:47 - setup_logging - scripts\setup_experiment.py:455 - INFO -   python -m scripts.continue_experiment --experiment-name A2C-percentage
