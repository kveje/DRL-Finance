2025-04-28 10:18:40 - setup_logging - utils\setup_logging.py:54 - INFO - Logging system initialized
2025-04-28 10:18:40 - setup_logging - utils\setup_logging.py:58 - INFO - Experiment logs will be saved to: experiments\discreteDQN
2025-04-28 10:18:40 - setup_logging - utils\setup_logging.py:68 - INFO - Log file: setup_discreteDQN.log
2025-04-28 10:18:40 - setup_logging - scripts\setup_experiment.py:87 - INFO - Setting up experiment: discreteDQN
2025-04-28 10:18:40 - setup_logging - scripts\setup_experiment.py:88 - INFO - Using assets: ['AXP', 'AMGN', 'AAPL', 'BA', 'CAT', 'CSCO', 'CVX', 'GS', 'HD', 'HON', 'IBM', 'INTC', 'JNJ', 'KO', 'JPM', 'MCD', 'MMM', 'MRK', 'MSFT', 'NKE', 'PG', 'TRV', 'UNH', 'CRM', 'VZ', 'V', 'WBA', 'WMT', 'DIS']
2025-04-28 10:18:40 - setup_logging - scripts\setup_experiment.py:89 - INFO - Training period: 2016-04-01 to 2022-03-31
2025-04-28 10:18:40 - setup_logging - scripts\setup_experiment.py:90 - INFO - Validation period: 2022-04-01 to 2023-03-31
2025-04-28 10:18:40 - data_manager - data\data_manager.py:102 - INFO - Data manager initialized
2025-04-28 10:18:40 - data_manager - data\data_manager.py:103 - INFO -   Raw data directory: data/raw
2025-04-28 10:18:40 - data_manager - data\data_manager.py:104 - INFO -   Processed data directory: data/processed
2025-04-28 10:18:40 - data_manager - data\data_manager.py:105 - INFO -   Normalized data directory: data/normalized
2025-04-28 10:18:40 - data_manager - data\data_manager.py:106 - INFO -   Use saved data: True
2025-04-28 10:18:40 - data_manager - data\data_manager.py:107 - INFO -   Save raw data: True
2025-04-28 10:18:40 - data_manager - data\data_manager.py:108 - INFO -   Save processed data: True
2025-04-28 10:18:40 - data_manager - data\data_manager.py:109 - INFO -   Save normalized data: True
2025-04-28 10:18:40 - data_manager - data\data_manager.py:110 - INFO -   Available sources: ['yahoo']
2025-04-28 10:18:40 - data_manager - data\data_manager.py:111 - INFO -   Available processors: ['technical_indicator', 'turbulence', 'vix']
2025-04-28 10:18:40 - setup_logging - scripts\setup_experiment.py:104 - INFO - Downloading data...
2025-04-28 10:18:40 - data_manager - data\data_manager.py:160 - INFO - Set current file base to: yahoo_AAPL-AMGN-AXP-BA-CAT-CRM-CSCO-CVX-DIS-GS-HD-HON-IBM-INTC-JNJ-JPM-KO-MCD-MMM-MRK-MSFT-NKE-PG-TRV-UNH-V-VZ-WBA-WMT_2016-04-01_2023-03-31_1d
2025-04-28 10:18:40 - data_manager - data\data_manager.py:212 - INFO - Loading saved raw data from data/raw\yahoo_AAPL-AMGN-AXP-BA-CAT-CRM-CSCO-CVX-DIS-GS-HD-HON-IBM-INTC-JNJ-JPM-KO-MCD-MMM-MRK-MSFT-NKE-PG-TRV-UNH-V-VZ-WBA-WMT_2016-04-01_2023-03-31_1d_raw.csv
2025-04-28 10:18:40 - setup_logging - scripts\setup_experiment.py:116 - INFO - Processing data with technical indicators...
2025-04-28 10:18:40 - data_manager - data\data_manager.py:280 - INFO - Applying processor: technical_indicator
2025-04-28 10:18:40 - technical_indicator - data\processors\technical_indicator.py:112 - INFO - Calculating indicators: ['sma', 'ema', 'rsi', 'macd', 'bollinger', 'atr', 'obv', 'adx', 'cci', 'stoch', 'mfi', 'roc', 'williams_r', 'vwap', 'ichimoku', 'keltner', 'linreg']
2025-04-28 10:18:51 - data_manager - data\data_manager.py:280 - INFO - Applying processor: vix
2025-04-28 10:18:53 - yahoo - data\sources\yahoo.py:89 - INFO - Downloaded data for 1 tickers from 2016-04-01 to 2023-03-30
2025-04-28 10:18:53 - data_manager - data\data_manager.py:317 - INFO - Saving processed data to: data/processed\yahoo_AAPL-AMGN-AXP-BA-CAT-CRM-CSCO-CVX-DIS-GS-HD-HON-IBM-INTC-JNJ-JPM-KO-MCD-MMM-MRK-MSFT-NKE-PG-TRV-UNH-V-VZ-WBA-WMT_2016-04-01_2023-03-31_1d_processed.csv
2025-04-28 10:18:55 - setup_logging - scripts\setup_experiment.py:125 - INFO - Normalizing data...
2025-04-28 10:18:55 - data_manager - data\data_manager.py:364 - INFO - Auto-generating feature groups from columns
2025-04-28 10:18:55 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to price features: ['open', 'high', 'low', 'close']
2025-04-28 10:18:55 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to volume features: ['volume']
2025-04-28 10:18:56 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to market features: ['vix']
2025-04-28 10:18:56 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to trend features: ['sma_5', 'sma_10', 'sma_20', 'sma_50', 'ema_5', 'ema_10', 'ema_20', 'ema_50', 'macd_line_12_26', 'macd_signal_9', 'macd_hist_12_26_9', 'vwap_daily', 'tenkan_sen_9', 'kijun_sen_26', 'senkou_span_a_26', 'senkou_span_b_52_26', 'chikou_span_26', 'keltner_middle_20', 'keltner_upper_20_10_2', 'keltner_lower_20_10_2']
2025-04-28 10:18:56 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to momentum features: ['rsi_14', 'cci_20', 'stoch_k_14', 'stoch_d_14_3', 'mfi_14', 'roc_12', 'williams_r_14']
2025-04-28 10:18:56 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to volatility features: ['bb_middle_20', 'bb_upper_20', 'bb_lower_20', 'bb_pct_b_20', 'atr_14', 'adx_14', 'pdi_14', 'ndi_14']
2025-04-28 10:18:57 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to volume_indicators features: ['obv']
2025-04-28 10:18:57 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to other features: ['linreg_slope_10', 'linreg_intercept_10', 'linreg_r2_10', 'linreg_slope_pvalue_10']
2025-04-28 10:18:57 - data_manager - data\data_manager.py:409 - INFO - Saving normalized data to: data/normalized\yahoo_AAPL-AMGN-AXP-BA-CAT-CRM-CSCO-CVX-DIS-GS-HD-HON-IBM-INTC-JNJ-JPM-KO-MCD-MMM-MRK-MSFT-NKE-PG-TRV-UNH-V-VZ-WBA-WMT_2016-04-01_2023-03-31_1d_normalized_percentage.csv
2025-04-28 10:18:59 - setup_logging - scripts\setup_experiment.py:135 - INFO - Splitting data into training and validation sets...
2025-04-28 10:18:59 - data_manager - data\data_manager.py:634 - WARNING - Test end date 2023-03-31 00:00:00 is after the latest available date 2023-03-30 00:00:00. Using 2023-03-30 00:00:00 instead.
2025-04-28 10:18:59 - data_manager - data\data_manager.py:709 - INFO - Resetting day indices for each split to start from 1
2025-04-28 10:18:59 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 0-1511 to 1-1512
2025-04-28 10:18:59 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 1512-1761 to 1-250
2025-04-28 10:18:59 - data_manager - data\data_manager.py:742 - INFO - Data split: Training: 43848 rows, Test: 7250 rows
2025-04-28 10:18:59 - data_manager - data\data_manager.py:634 - WARNING - Test end date 2023-03-31 00:00:00 is after the latest available date 2023-03-30 00:00:00. Using 2023-03-30 00:00:00 instead.
2025-04-28 10:18:59 - data_manager - data\data_manager.py:709 - INFO - Resetting day indices for each split to start from 1
2025-04-28 10:18:59 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 0-1511 to 1-1512
2025-04-28 10:18:59 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 1512-1761 to 1-250
2025-04-28 10:18:59 - data_manager - data\data_manager.py:742 - INFO - Data split: Training: 43848 rows, Test: 7250 rows
2025-04-28 10:18:59 - data_manager - data\data_manager.py:634 - WARNING - Test end date 2023-03-31 00:00:00 is after the latest available date 2023-03-30 00:00:00. Using 2023-03-30 00:00:00 instead.
2025-04-28 10:18:59 - data_manager - data\data_manager.py:709 - INFO - Resetting day indices for each split to start from 1
2025-04-28 10:18:59 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 0-1511 to 1-1512
2025-04-28 10:18:59 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 1512-1761 to 1-250
2025-04-28 10:18:59 - data_manager - data\data_manager.py:742 - INFO - Data split: Training: 43848 rows, Test: 7250 rows
2025-04-28 10:18:59 - setup_logging - scripts\setup_experiment.py:179 - INFO - Generating data visualizations...
2025-04-28 10:18:59 - data_visualization - visualization\data_visualization.py:53 - INFO - Visualization tool initialized with output directory: experiments\discreteDQN\visualizations
2025-04-28 10:18:59 - data_visualization - visualization\data_visualization.py:1393 - INFO - Generating raw data visualizations...
2025-04-28 10:19:01 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:02 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:02 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:02 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:03 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:03 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:03 - data_visualization - visualization\data_visualization.py:1455 - INFO - Generating processed data visualizations...
2025-04-28 10:19:22 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:22 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:23 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:23 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:26 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:26 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:26 - data_visualization - visualization\data_visualization.py:1517 - INFO - Generating normalized data visualizations...
2025-04-28 10:19:38 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:39 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:39 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:40 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:41 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:42 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:45 - data_visualization - visualization\data_visualization.py:334 - INFO - Raw vs. normalized comparison saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:45 - data_visualization - visualization\data_visualization.py:1584 - INFO - All visualizations completed and saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:45 - data_visualization - visualization\data_visualization.py:1393 - INFO - Generating raw data visualizations...
2025-04-28 10:19:46 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:46 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:46 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:46 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:46 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:47 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:47 - data_visualization - visualization\data_visualization.py:1455 - INFO - Generating processed data visualizations...
2025-04-28 10:19:54 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:55 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:55 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:55 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:57 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:58 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\discreteDQN\visualizations
2025-04-28 10:19:58 - data_visualization - visualization\data_visualization.py:1517 - INFO - Generating normalized data visualizations...
2025-04-28 10:20:06 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:20:06 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:20:06 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:20:07 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:20:08 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\discreteDQN\visualizations
2025-04-28 10:20:09 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\discreteDQN\visualizations
2025-04-28 10:20:10 - data_visualization - visualization\data_visualization.py:334 - INFO - Raw vs. normalized comparison saved to experiments\discreteDQN\visualizations
2025-04-28 10:20:10 - data_visualization - visualization\data_visualization.py:1584 - INFO - All visualizations completed and saved to experiments\discreteDQN\visualizations
2025-04-28 10:20:11 - data_visualization - visualization\data_visualization.py:1170 - INFO - Training vs validation comparison saved to experiments\discreteDQN\visualizations
2025-04-28 10:20:11 - setup_logging - scripts\setup_experiment.py:217 - INFO - Data visualizations saved to experiments\discreteDQN\visualizations
2025-04-28 10:20:11 - setup_logging - scripts\setup_experiment.py:224 - INFO - Saving data...
2025-04-28 10:20:14 - setup_logging - scripts\setup_experiment.py:265 - INFO - Creating training and validation environments...
2025-04-28 10:20:14 - trading_env - environments\trading_env.py:52 - INFO - Initializing TradingEnv
2025-04-28 10:20:14 - trading_env - environments\trading_env.py:496 - INFO - Environment initialized with 29 assets
2025-04-28 10:20:14 - trading_env - environments\trading_env.py:497 - INFO - Initial balance: $100000.00
2025-04-28 10:20:14 - trading_env - environments\trading_env.py:498 - INFO - Window size: 3
2025-04-28 10:20:14 - trading_env - environments\trading_env.py:499 - INFO - Data length: 43848
2025-04-28 10:20:14 - trading_env - environments\trading_env.py:500 - INFO - Number of stocks: 29
2025-04-28 10:20:14 - trading_env - environments\trading_env.py:501 - INFO - Action space: Box(-2147483646, 2147483645, (29,), int32)
2025-04-28 10:20:14 - trading_env - environments\trading_env.py:491 - INFO - Random seed set to 184903
2025-04-28 10:20:14 - trading_env - environments\trading_env.py:52 - INFO - Initializing TradingEnv
2025-04-28 10:20:14 - trading_env - environments\trading_env.py:496 - INFO - Environment initialized with 29 assets
2025-04-28 10:20:14 - trading_env - environments\trading_env.py:497 - INFO - Initial balance: $100000.00
2025-04-28 10:20:14 - trading_env - environments\trading_env.py:498 - INFO - Window size: 3
2025-04-28 10:20:14 - trading_env - environments\trading_env.py:499 - INFO - Data length: 7250
2025-04-28 10:20:14 - trading_env - environments\trading_env.py:500 - INFO - Number of stocks: 29
2025-04-28 10:20:14 - trading_env - environments\trading_env.py:501 - INFO - Action space: Box(-2147483646, 2147483645, (29,), int32)
2025-04-28 10:20:14 - trading_env - environments\trading_env.py:491 - INFO - Random seed set to 578252
2025-04-28 10:20:14 - setup_logging - scripts\setup_experiment.py:344 - INFO - Initializing DiscreteDQNAgent...
2025-04-28 10:28:17 - setup_logging - utils\setup_logging.py:54 - INFO - Logging system initialized
2025-04-28 10:28:17 - setup_logging - utils\setup_logging.py:58 - INFO - Experiment logs will be saved to: experiments\discreteDQN
2025-04-28 10:28:17 - setup_logging - utils\setup_logging.py:68 - INFO - Log file: setup_discreteDQN.log
2025-04-28 10:28:17 - setup_logging - scripts\setup_experiment.py:87 - INFO - Setting up experiment: discreteDQN
2025-04-28 10:28:17 - setup_logging - scripts\setup_experiment.py:88 - INFO - Using assets: ['AXP', 'AMGN', 'AAPL', 'BA', 'CAT', 'CSCO', 'CVX', 'GS', 'HD', 'HON', 'IBM', 'INTC', 'JNJ', 'KO', 'JPM', 'MCD', 'MMM', 'MRK', 'MSFT', 'NKE', 'PG', 'TRV', 'UNH', 'CRM', 'VZ', 'V', 'WBA', 'WMT', 'DIS']
2025-04-28 10:28:17 - setup_logging - scripts\setup_experiment.py:89 - INFO - Training period: 2016-04-01 to 2022-03-31
2025-04-28 10:28:17 - setup_logging - scripts\setup_experiment.py:90 - INFO - Validation period: 2022-04-01 to 2023-03-31
2025-04-28 10:28:17 - data_manager - data\data_manager.py:102 - INFO - Data manager initialized
2025-04-28 10:28:17 - data_manager - data\data_manager.py:103 - INFO -   Raw data directory: data/raw
2025-04-28 10:28:17 - data_manager - data\data_manager.py:104 - INFO -   Processed data directory: data/processed
2025-04-28 10:28:17 - data_manager - data\data_manager.py:105 - INFO -   Normalized data directory: data/normalized
2025-04-28 10:28:17 - data_manager - data\data_manager.py:106 - INFO -   Use saved data: True
2025-04-28 10:28:17 - data_manager - data\data_manager.py:107 - INFO -   Save raw data: True
2025-04-28 10:28:17 - data_manager - data\data_manager.py:108 - INFO -   Save processed data: True
2025-04-28 10:28:17 - data_manager - data\data_manager.py:109 - INFO -   Save normalized data: True
2025-04-28 10:28:17 - data_manager - data\data_manager.py:110 - INFO -   Available sources: ['yahoo']
2025-04-28 10:28:17 - data_manager - data\data_manager.py:111 - INFO -   Available processors: ['technical_indicator', 'turbulence', 'vix']
2025-04-28 10:28:17 - setup_logging - scripts\setup_experiment.py:104 - INFO - Downloading data...
2025-04-28 10:28:17 - data_manager - data\data_manager.py:160 - INFO - Set current file base to: yahoo_AAPL-AMGN-AXP-BA-CAT-CRM-CSCO-CVX-DIS-GS-HD-HON-IBM-INTC-JNJ-JPM-KO-MCD-MMM-MRK-MSFT-NKE-PG-TRV-UNH-V-VZ-WBA-WMT_2016-04-01_2023-03-31_1d
2025-04-28 10:28:17 - data_manager - data\data_manager.py:212 - INFO - Loading saved raw data from data/raw\yahoo_AAPL-AMGN-AXP-BA-CAT-CRM-CSCO-CVX-DIS-GS-HD-HON-IBM-INTC-JNJ-JPM-KO-MCD-MMM-MRK-MSFT-NKE-PG-TRV-UNH-V-VZ-WBA-WMT_2016-04-01_2023-03-31_1d_raw.csv
2025-04-28 10:28:17 - setup_logging - scripts\setup_experiment.py:116 - INFO - Processing data with technical indicators...
2025-04-28 10:28:17 - data_manager - data\data_manager.py:280 - INFO - Applying processor: technical_indicator
2025-04-28 10:28:17 - technical_indicator - data\processors\technical_indicator.py:112 - INFO - Calculating indicators: ['sma', 'ema', 'rsi', 'macd', 'bollinger', 'atr', 'obv', 'adx', 'cci', 'stoch', 'mfi', 'roc', 'williams_r', 'vwap', 'ichimoku', 'keltner', 'linreg']
2025-04-28 10:28:29 - data_manager - data\data_manager.py:280 - INFO - Applying processor: vix
2025-04-28 10:28:29 - yahoo - data\sources\yahoo.py:89 - INFO - Downloaded data for 1 tickers from 2016-04-01 to 2023-03-30
2025-04-28 10:28:29 - data_manager - data\data_manager.py:317 - INFO - Saving processed data to: data/processed\yahoo_AAPL-AMGN-AXP-BA-CAT-CRM-CSCO-CVX-DIS-GS-HD-HON-IBM-INTC-JNJ-JPM-KO-MCD-MMM-MRK-MSFT-NKE-PG-TRV-UNH-V-VZ-WBA-WMT_2016-04-01_2023-03-31_1d_processed.csv
2025-04-28 10:28:31 - setup_logging - scripts\setup_experiment.py:125 - INFO - Normalizing data...
2025-04-28 10:28:31 - data_manager - data\data_manager.py:364 - INFO - Auto-generating feature groups from columns
2025-04-28 10:28:31 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to price features: ['open', 'high', 'low', 'close']
2025-04-28 10:28:32 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to volume features: ['volume']
2025-04-28 10:28:32 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to market features: ['vix']
2025-04-28 10:28:32 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to trend features: ['sma_5', 'sma_10', 'sma_20', 'sma_50', 'ema_5', 'ema_10', 'ema_20', 'ema_50', 'macd_line_12_26', 'macd_signal_9', 'macd_hist_12_26_9', 'vwap_daily', 'tenkan_sen_9', 'kijun_sen_26', 'senkou_span_a_26', 'senkou_span_b_52_26', 'chikou_span_26', 'keltner_middle_20', 'keltner_upper_20_10_2', 'keltner_lower_20_10_2']
2025-04-28 10:28:32 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to momentum features: ['rsi_14', 'cci_20', 'stoch_k_14', 'stoch_d_14_3', 'mfi_14', 'roc_12', 'williams_r_14']
2025-04-28 10:28:33 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to volatility features: ['bb_middle_20', 'bb_upper_20', 'bb_lower_20', 'bb_pct_b_20', 'atr_14', 'adx_14', 'pdi_14', 'ndi_14']
2025-04-28 10:28:33 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to volume_indicators features: ['obv']
2025-04-28 10:28:33 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to other features: ['linreg_slope_10', 'linreg_intercept_10', 'linreg_r2_10', 'linreg_slope_pvalue_10']
2025-04-28 10:28:33 - data_manager - data\data_manager.py:409 - INFO - Saving normalized data to: data/normalized\yahoo_AAPL-AMGN-AXP-BA-CAT-CRM-CSCO-CVX-DIS-GS-HD-HON-IBM-INTC-JNJ-JPM-KO-MCD-MMM-MRK-MSFT-NKE-PG-TRV-UNH-V-VZ-WBA-WMT_2016-04-01_2023-03-31_1d_normalized_percentage.csv
2025-04-28 10:28:35 - setup_logging - scripts\setup_experiment.py:135 - INFO - Splitting data into training and validation sets...
2025-04-28 10:28:35 - data_manager - data\data_manager.py:634 - WARNING - Test end date 2023-03-31 00:00:00 is after the latest available date 2023-03-30 00:00:00. Using 2023-03-30 00:00:00 instead.
2025-04-28 10:28:35 - data_manager - data\data_manager.py:709 - INFO - Resetting day indices for each split to start from 1
2025-04-28 10:28:35 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 0-1511 to 1-1512
2025-04-28 10:28:35 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 1512-1761 to 1-250
2025-04-28 10:28:35 - data_manager - data\data_manager.py:742 - INFO - Data split: Training: 43848 rows, Test: 7250 rows
2025-04-28 10:28:35 - data_manager - data\data_manager.py:634 - WARNING - Test end date 2023-03-31 00:00:00 is after the latest available date 2023-03-30 00:00:00. Using 2023-03-30 00:00:00 instead.
2025-04-28 10:28:35 - data_manager - data\data_manager.py:709 - INFO - Resetting day indices for each split to start from 1
2025-04-28 10:28:35 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 0-1511 to 1-1512
2025-04-28 10:28:35 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 1512-1761 to 1-250
2025-04-28 10:28:35 - data_manager - data\data_manager.py:742 - INFO - Data split: Training: 43848 rows, Test: 7250 rows
2025-04-28 10:28:36 - data_manager - data\data_manager.py:634 - WARNING - Test end date 2023-03-31 00:00:00 is after the latest available date 2023-03-30 00:00:00. Using 2023-03-30 00:00:00 instead.
2025-04-28 10:28:36 - data_manager - data\data_manager.py:709 - INFO - Resetting day indices for each split to start from 1
2025-04-28 10:28:36 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 0-1511 to 1-1512
2025-04-28 10:28:36 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 1512-1761 to 1-250
2025-04-28 10:28:36 - data_manager - data\data_manager.py:742 - INFO - Data split: Training: 43848 rows, Test: 7250 rows
2025-04-28 10:28:36 - setup_logging - scripts\setup_experiment.py:179 - INFO - Generating data visualizations...
2025-04-28 10:28:36 - data_visualization - visualization\data_visualization.py:53 - INFO - Visualization tool initialized with output directory: experiments\discreteDQN\visualizations
2025-04-28 10:28:36 - data_visualization - visualization\data_visualization.py:1393 - INFO - Generating raw data visualizations...
2025-04-28 10:28:38 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:28:38 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:28:39 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:28:39 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:28:39 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\discreteDQN\visualizations
2025-04-28 10:28:39 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\discreteDQN\visualizations
2025-04-28 10:28:39 - data_visualization - visualization\data_visualization.py:1455 - INFO - Generating processed data visualizations...
2025-04-28 10:28:59 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:28:59 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:00 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:00 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:03 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:03 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:03 - data_visualization - visualization\data_visualization.py:1517 - INFO - Generating normalized data visualizations...
2025-04-28 10:29:15 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:15 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:16 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:16 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:18 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:18 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:21 - data_visualization - visualization\data_visualization.py:334 - INFO - Raw vs. normalized comparison saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:21 - data_visualization - visualization\data_visualization.py:1584 - INFO - All visualizations completed and saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:21 - data_visualization - visualization\data_visualization.py:1393 - INFO - Generating raw data visualizations...
2025-04-28 10:29:22 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:22 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:23 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:23 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:23 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:23 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:23 - data_visualization - visualization\data_visualization.py:1455 - INFO - Generating processed data visualizations...
2025-04-28 10:29:31 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:31 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:32 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:32 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:34 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:35 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:35 - data_visualization - visualization\data_visualization.py:1517 - INFO - Generating normalized data visualizations...
2025-04-28 10:29:42 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:43 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:43 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:43 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:45 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:45 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:47 - data_visualization - visualization\data_visualization.py:334 - INFO - Raw vs. normalized comparison saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:47 - data_visualization - visualization\data_visualization.py:1584 - INFO - All visualizations completed and saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:48 - data_visualization - visualization\data_visualization.py:1170 - INFO - Training vs validation comparison saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:48 - setup_logging - scripts\setup_experiment.py:217 - INFO - Data visualizations saved to experiments\discreteDQN\visualizations
2025-04-28 10:29:48 - setup_logging - scripts\setup_experiment.py:224 - INFO - Saving data...
2025-04-28 10:29:50 - setup_logging - scripts\setup_experiment.py:265 - INFO - Creating training and validation environments...
2025-04-28 10:29:50 - trading_env - environments\trading_env.py:52 - INFO - Initializing TradingEnv
2025-04-28 10:29:50 - trading_env - environments\trading_env.py:496 - INFO - Environment initialized with 29 assets
2025-04-28 10:29:50 - trading_env - environments\trading_env.py:497 - INFO - Initial balance: $100000.00
2025-04-28 10:29:50 - trading_env - environments\trading_env.py:498 - INFO - Window size: 3
2025-04-28 10:29:50 - trading_env - environments\trading_env.py:499 - INFO - Data length: 43848
2025-04-28 10:29:50 - trading_env - environments\trading_env.py:500 - INFO - Number of stocks: 29
2025-04-28 10:29:50 - trading_env - environments\trading_env.py:501 - INFO - Action space: Box(-2147483646, 2147483645, (29,), int32)
2025-04-28 10:29:50 - trading_env - environments\trading_env.py:491 - INFO - Random seed set to 523982
2025-04-28 10:29:50 - trading_env - environments\trading_env.py:52 - INFO - Initializing TradingEnv
2025-04-28 10:29:51 - trading_env - environments\trading_env.py:496 - INFO - Environment initialized with 29 assets
2025-04-28 10:29:51 - trading_env - environments\trading_env.py:497 - INFO - Initial balance: $100000.00
2025-04-28 10:29:51 - trading_env - environments\trading_env.py:498 - INFO - Window size: 3
2025-04-28 10:29:51 - trading_env - environments\trading_env.py:499 - INFO - Data length: 7250
2025-04-28 10:29:51 - trading_env - environments\trading_env.py:500 - INFO - Number of stocks: 29
2025-04-28 10:29:51 - trading_env - environments\trading_env.py:501 - INFO - Action space: Box(-2147483646, 2147483645, (29,), int32)
2025-04-28 10:29:51 - trading_env - environments\trading_env.py:491 - INFO - Random seed set to 217139
2025-04-28 10:29:51 - setup_logging - scripts\setup_experiment.py:344 - INFO - Initializing DiscreteDQNAgent...
2025-04-28 10:29:51 - discrete_dqn_agent - models\agents\discrete_dqn_agent.py:209 - INFO - Created 21 action bins for each asset
2025-04-28 10:29:51 - discrete_dqn_agent - models\agents\discrete_dqn_agent.py:210 - INFO - Action bins for first asset: [-100.  -90.  -80.  -70.  -60.  -50.  -40.  -30.  -20.  -10.    0.   10.
   20.   30.   40.   50.   60.   70.   80.   90.  100.]
2025-04-28 10:29:51 - discrete_dqn_agent - models\agents\discrete_dqn_agent.py:67 - INFO - DiscreteDQN Network architecture: DiscreteDQNNetwork(
  (activation): ReLU()
  (layers): ModuleList(
    (0): Linear(in_features=4091, out_features=256, bias=True)
    (1): Linear(in_features=256, out_features=128, bias=True)
    (2): Dropout(p=0.1, inplace=False)
    (3): ReLU()
    (4): Linear(in_features=128, out_features=64, bias=True)
    (5): Dropout(p=0.1, inplace=False)
    (6): ReLU()
  )
  (output_layer): Linear(in_features=64, out_features=609, bias=True)
)
2025-04-28 10:29:51 - discrete_dqn_agent - models\agents\discrete_dqn_agent.py:67 - INFO - DiscreteDQN Network architecture: DiscreteDQNNetwork(
  (activation): ReLU()
  (layers): ModuleList(
    (0): Linear(in_features=4091, out_features=256, bias=True)
    (1): Linear(in_features=256, out_features=128, bias=True)
    (2): Dropout(p=0.1, inplace=False)
    (3): ReLU()
    (4): Linear(in_features=128, out_features=64, bias=True)
    (5): Dropout(p=0.1, inplace=False)
    (6): ReLU()
  )
  (output_layer): Linear(in_features=64, out_features=609, bias=True)
)
2025-04-28 10:29:53 - setup_logging - scripts\setup_experiment.py:454 - INFO - Setting up experiment manager...
2025-04-28 10:29:53 - experiment_discreteDQN - models\experiment_manager.py:196 - INFO - Saved experiment configuration to experiments\discreteDQN\config
2025-04-28 10:29:53 - experiment_discreteDQN - models\experiment_manager.py:237 - INFO - Saved data information to experiments\discreteDQN\data
2025-04-28 10:29:53 - experiment_discreteDQN - models\experiment_manager.py:151 - INFO - Initialized experiment: discreteDQN
2025-04-28 10:29:53 - setup_logging - scripts\setup_experiment.py:473 - INFO - Saving experiment manager for later training...
2025-04-28 10:29:53 - setup_logging - scripts\setup_experiment.py:473 - INFO - Saving experiment manager for later training...
2025-04-28 10:29:53 - setup_logging - scripts\setup_experiment.py:477 - INFO - Experiment setup completed: discreteDQN
2025-04-28 10:29:53 - setup_logging - scripts\setup_experiment.py:477 - INFO - Experiment setup completed: discreteDQN
2025-04-28 10:29:53 - setup_logging - scripts\setup_experiment.py:478 - INFO - All required files have been saved to experiments\discreteDQN
2025-04-28 10:29:53 - setup_logging - scripts\setup_experiment.py:478 - INFO - All required files have been saved to experiments\discreteDQN
2025-04-28 10:29:53 - setup_logging - scripts\setup_experiment.py:479 - INFO - The experiment is ready to be trained with:
2025-04-28 10:29:53 - setup_logging - scripts\setup_experiment.py:479 - INFO - The experiment is ready to be trained with:
2025-04-28 10:29:53 - setup_logging - scripts\setup_experiment.py:480 - INFO -   python -m scripts.train_experiment --experiment-name discreteDQN
2025-04-28 10:29:53 - setup_logging - scripts\setup_experiment.py:480 - INFO -   python -m scripts.train_experiment --experiment-name discreteDQN
2025-04-28 10:29:53 - setup_logging - scripts\setup_experiment.py:481 - INFO - To continue training from a checkpoint later, use:
2025-04-28 10:29:53 - setup_logging - scripts\setup_experiment.py:481 - INFO - To continue training from a checkpoint later, use:
2025-04-28 10:29:53 - setup_logging - scripts\setup_experiment.py:482 - INFO -   python -m scripts.continue_experiment --experiment-name discreteDQN
2025-04-28 10:29:53 - setup_logging - scripts\setup_experiment.py:482 - INFO -   python -m scripts.continue_experiment --experiment-name discreteDQN
2025-04-29 16:31:21 - setup_logging - utils\setup_logging.py:54 - INFO - Logging system initialized
2025-04-29 16:31:21 - setup_logging - utils\setup_logging.py:58 - INFO - Experiment logs will be saved to: experiments\discreteDQN
2025-04-29 16:31:21 - setup_logging - utils\setup_logging.py:68 - INFO - Log file: setup_discreteDQN.log
2025-04-29 16:31:21 - setup_logging - scripts\setup_experiment.py:90 - INFO - Setting up experiment: discreteDQN
2025-04-29 16:31:21 - setup_logging - scripts\setup_experiment.py:91 - INFO - Using assets: ['AXP', 'AMGN', 'AAPL', 'BA', 'CAT', 'CSCO', 'CVX', 'GS', 'HD', 'HON', 'IBM', 'INTC', 'JNJ', 'KO', 'JPM', 'MCD', 'MMM', 'MRK', 'MSFT', 'NKE', 'PG', 'TRV', 'UNH', 'CRM', 'VZ', 'V', 'WBA', 'WMT', 'DIS']
2025-04-29 16:31:21 - setup_logging - scripts\setup_experiment.py:92 - INFO - Training period: 2016-04-01 to 2022-03-31
2025-04-29 16:31:21 - setup_logging - scripts\setup_experiment.py:93 - INFO - Validation period: 2022-04-01 to 2023-03-31
2025-04-29 16:31:21 - data_manager - data\data_manager.py:102 - INFO - Data manager initialized
2025-04-29 16:31:21 - data_manager - data\data_manager.py:103 - INFO -   Raw data directory: data/raw
2025-04-29 16:31:21 - data_manager - data\data_manager.py:104 - INFO -   Processed data directory: data/processed
2025-04-29 16:31:21 - data_manager - data\data_manager.py:105 - INFO -   Normalized data directory: data/normalized
2025-04-29 16:31:21 - data_manager - data\data_manager.py:106 - INFO -   Use saved data: True
2025-04-29 16:31:21 - data_manager - data\data_manager.py:107 - INFO -   Save raw data: True
2025-04-29 16:31:21 - data_manager - data\data_manager.py:108 - INFO -   Save processed data: True
2025-04-29 16:31:21 - data_manager - data\data_manager.py:109 - INFO -   Save normalized data: True
2025-04-29 16:31:21 - data_manager - data\data_manager.py:110 - INFO -   Available sources: ['yahoo']
2025-04-29 16:31:21 - data_manager - data\data_manager.py:111 - INFO -   Available processors: ['technical_indicator', 'turbulence', 'vix']
2025-04-29 16:31:21 - setup_logging - scripts\setup_experiment.py:107 - INFO - Downloading data...
2025-04-29 16:31:21 - data_manager - data\data_manager.py:160 - INFO - Set current file base to: yahoo_AAPL-AMGN-AXP-BA-CAT-CRM-CSCO-CVX-DIS-GS-HD-HON-IBM-INTC-JNJ-JPM-KO-MCD-MMM-MRK-MSFT-NKE-PG-TRV-UNH-V-VZ-WBA-WMT_2016-04-01_2023-03-31_1d
2025-04-29 16:31:21 - data_manager - data\data_manager.py:212 - INFO - Loading saved raw data from data/raw\yahoo_AAPL-AMGN-AXP-BA-CAT-CRM-CSCO-CVX-DIS-GS-HD-HON-IBM-INTC-JNJ-JPM-KO-MCD-MMM-MRK-MSFT-NKE-PG-TRV-UNH-V-VZ-WBA-WMT_2016-04-01_2023-03-31_1d_raw.csv
2025-04-29 16:31:21 - setup_logging - scripts\setup_experiment.py:119 - INFO - Processing data with technical indicators...
2025-04-29 16:31:21 - data_manager - data\data_manager.py:280 - INFO - Applying processor: technical_indicator
2025-04-29 16:31:21 - technical_indicator - data\processors\technical_indicator.py:112 - INFO - Calculating indicators: ['sma', 'ema', 'rsi', 'macd', 'bollinger', 'atr', 'obv', 'adx', 'cci', 'stoch', 'mfi', 'roc', 'williams_r', 'vwap', 'ichimoku', 'keltner', 'linreg']
2025-04-29 16:31:32 - data_manager - data\data_manager.py:280 - INFO - Applying processor: vix
2025-04-29 16:31:33 - yahoo - data\sources\yahoo.py:89 - INFO - Downloaded data for 1 tickers from 2016-04-01 to 2023-03-30
2025-04-29 16:31:33 - data_manager - data\data_manager.py:317 - INFO - Saving processed data to: data/processed\yahoo_AAPL-AMGN-AXP-BA-CAT-CRM-CSCO-CVX-DIS-GS-HD-HON-IBM-INTC-JNJ-JPM-KO-MCD-MMM-MRK-MSFT-NKE-PG-TRV-UNH-V-VZ-WBA-WMT_2016-04-01_2023-03-31_1d_processed.csv
2025-04-29 16:31:34 - setup_logging - scripts\setup_experiment.py:128 - INFO - Normalizing data...
2025-04-29 16:31:34 - data_manager - data\data_manager.py:364 - INFO - Auto-generating feature groups from columns
2025-04-29 16:31:34 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to price features: ['open', 'high', 'low', 'close']
2025-04-29 16:31:34 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to volume features: ['volume']
2025-04-29 16:31:34 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to market features: ['vix']
2025-04-29 16:31:35 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to trend features: ['sma_5', 'sma_10', 'sma_20', 'sma_50', 'ema_5', 'ema_10', 'ema_20', 'ema_50', 'macd_line_12_26', 'macd_signal_9', 'macd_hist_12_26_9', 'vwap_daily', 'tenkan_sen_9', 'kijun_sen_26', 'senkou_span_a_26', 'senkou_span_b_52_26', 'chikou_span_26', 'keltner_middle_20', 'keltner_upper_20_10_2', 'keltner_lower_20_10_2']
2025-04-29 16:31:35 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to momentum features: ['rsi_14', 'cci_20', 'stoch_k_14', 'stoch_d_14_3', 'mfi_14', 'roc_12', 'williams_r_14']
2025-04-29 16:31:35 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to volatility features: ['bb_middle_20', 'bb_upper_20', 'bb_lower_20', 'bb_pct_b_20', 'atr_14', 'adx_14', 'pdi_14', 'ndi_14']
2025-04-29 16:31:35 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to volume_indicators features: ['obv']
2025-04-29 16:31:35 - data_manager - data\data_manager.py:384 - INFO - Applying percentage normalization to other features: ['linreg_slope_10', 'linreg_intercept_10', 'linreg_r2_10', 'linreg_slope_pvalue_10']
2025-04-29 16:31:35 - data_manager - data\data_manager.py:409 - INFO - Saving normalized data to: data/normalized\yahoo_AAPL-AMGN-AXP-BA-CAT-CRM-CSCO-CVX-DIS-GS-HD-HON-IBM-INTC-JNJ-JPM-KO-MCD-MMM-MRK-MSFT-NKE-PG-TRV-UNH-V-VZ-WBA-WMT_2016-04-01_2023-03-31_1d_normalized_percentage.csv
2025-04-29 16:31:37 - setup_logging - scripts\setup_experiment.py:138 - INFO - Splitting data into training and validation sets...
2025-04-29 16:31:37 - data_manager - data\data_manager.py:634 - WARNING - Test end date 2023-03-31 00:00:00 is after the latest available date 2023-03-30 00:00:00. Using 2023-03-30 00:00:00 instead.
2025-04-29 16:31:37 - data_manager - data\data_manager.py:709 - INFO - Resetting day indices for each split to start from 1
2025-04-29 16:31:37 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 0-1511 to 1-1512
2025-04-29 16:31:37 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 1512-1761 to 1-250
2025-04-29 16:31:37 - data_manager - data\data_manager.py:742 - INFO - Data split: Training: 43848 rows, Test: 7250 rows
2025-04-29 16:31:37 - data_manager - data\data_manager.py:634 - WARNING - Test end date 2023-03-31 00:00:00 is after the latest available date 2023-03-30 00:00:00. Using 2023-03-30 00:00:00 instead.
2025-04-29 16:31:37 - data_manager - data\data_manager.py:709 - INFO - Resetting day indices for each split to start from 1
2025-04-29 16:31:37 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 0-1511 to 1-1512
2025-04-29 16:31:37 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 1512-1761 to 1-250
2025-04-29 16:31:37 - data_manager - data\data_manager.py:742 - INFO - Data split: Training: 43848 rows, Test: 7250 rows
2025-04-29 16:31:37 - data_manager - data\data_manager.py:634 - WARNING - Test end date 2023-03-31 00:00:00 is after the latest available date 2023-03-30 00:00:00. Using 2023-03-30 00:00:00 instead.
2025-04-29 16:31:37 - data_manager - data\data_manager.py:709 - INFO - Resetting day indices for each split to start from 1
2025-04-29 16:31:37 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 0-1511 to 1-1512
2025-04-29 16:31:37 - data_manager - data\data_manager.py:767 - INFO - Reset day index from 1512-1761 to 1-250
2025-04-29 16:31:37 - data_manager - data\data_manager.py:742 - INFO - Data split: Training: 43848 rows, Test: 7250 rows
2025-04-29 16:31:37 - setup_logging - scripts\setup_experiment.py:182 - INFO - Generating data visualizations...
2025-04-29 16:31:37 - data_visualization - visualization\data_visualization.py:53 - INFO - Visualization tool initialized with output directory: experiments\discreteDQN\visualizations
2025-04-29 16:31:37 - data_visualization - visualization\data_visualization.py:1393 - INFO - Generating raw data visualizations...
2025-04-29 16:31:39 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:31:39 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:31:40 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:31:40 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:31:40 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\discreteDQN\visualizations
2025-04-29 16:31:40 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\discreteDQN\visualizations
2025-04-29 16:31:40 - data_visualization - visualization\data_visualization.py:1455 - INFO - Generating processed data visualizations...
2025-04-29 16:31:55 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:31:55 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:31:55 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:31:56 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:31:58 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\discreteDQN\visualizations
2025-04-29 16:31:58 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\discreteDQN\visualizations
2025-04-29 16:31:58 - data_visualization - visualization\data_visualization.py:1517 - INFO - Generating normalized data visualizations...
2025-04-29 16:32:07 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:07 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:07 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:08 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:09 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:09 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:12 - data_visualization - visualization\data_visualization.py:334 - INFO - Raw vs. normalized comparison saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:12 - data_visualization - visualization\data_visualization.py:1584 - INFO - All visualizations completed and saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:12 - data_visualization - visualization\data_visualization.py:1393 - INFO - Generating raw data visualizations...
2025-04-29 16:32:12 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:13 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:13 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:13 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:13 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:13 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:13 - data_visualization - visualization\data_visualization.py:1455 - INFO - Generating processed data visualizations...
2025-04-29 16:32:19 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:19 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:20 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:20 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:22 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:22 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:22 - data_visualization - visualization\data_visualization.py:1517 - INFO - Generating normalized data visualizations...
2025-04-29 16:32:28 - data_visualization - visualization\data_visualization.py:701 - INFO - Aggregate distribution plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:28 - data_visualization - visualization\data_visualization.py:785 - INFO - Time series bands plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:29 - data_visualization - visualization\data_visualization.py:854 - INFO - Feature evolution plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:29 - data_visualization - visualization\data_visualization.py:1294 - INFO - Grouped time series plots saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:30 - data_visualization - visualization\data_visualization.py:954 - INFO - Aggregate correlation matrix saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:31 - data_visualization - visualization\data_visualization.py:628 - INFO - Anomaly detection plot saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:32 - data_visualization - visualization\data_visualization.py:334 - INFO - Raw vs. normalized comparison saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:32 - data_visualization - visualization\data_visualization.py:1584 - INFO - All visualizations completed and saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:33 - data_visualization - visualization\data_visualization.py:1170 - INFO - Training vs validation comparison saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:33 - setup_logging - scripts\setup_experiment.py:220 - INFO - Data visualizations saved to experiments\discreteDQN\visualizations
2025-04-29 16:32:33 - setup_logging - scripts\setup_experiment.py:227 - INFO - Saving data...
2025-04-29 16:32:34 - setup_logging - scripts\setup_experiment.py:268 - INFO - Creating training and validation environments...
2025-04-29 16:32:34 - trading_env - environments\trading_env.py:52 - INFO - Initializing TradingEnv
2025-04-29 16:32:34 - trading_env - environments\trading_env.py:496 - INFO - Environment initialized with 29 assets
2025-04-29 16:32:34 - trading_env - environments\trading_env.py:497 - INFO - Initial balance: $100000.00
2025-04-29 16:32:34 - trading_env - environments\trading_env.py:498 - INFO - Window size: 3
2025-04-29 16:32:34 - trading_env - environments\trading_env.py:499 - INFO - Data length: 43848
2025-04-29 16:32:34 - trading_env - environments\trading_env.py:500 - INFO - Number of stocks: 29
2025-04-29 16:32:34 - trading_env - environments\trading_env.py:501 - INFO - Action space: Box(-2147483646, 2147483645, (29,), int32)
2025-04-29 16:32:34 - trading_env - environments\trading_env.py:491 - INFO - Random seed set to 212561
2025-04-29 16:32:34 - trading_env - environments\trading_env.py:52 - INFO - Initializing TradingEnv
2025-04-29 16:32:34 - trading_env - environments\trading_env.py:496 - INFO - Environment initialized with 29 assets
2025-04-29 16:32:34 - trading_env - environments\trading_env.py:497 - INFO - Initial balance: $100000.00
2025-04-29 16:32:34 - trading_env - environments\trading_env.py:498 - INFO - Window size: 3
2025-04-29 16:32:34 - trading_env - environments\trading_env.py:499 - INFO - Data length: 7250
2025-04-29 16:32:34 - trading_env - environments\trading_env.py:500 - INFO - Number of stocks: 29
2025-04-29 16:32:34 - trading_env - environments\trading_env.py:501 - INFO - Action space: Box(-2147483646, 2147483645, (29,), int32)
2025-04-29 16:32:34 - trading_env - environments\trading_env.py:491 - INFO - Random seed set to 156743
2025-04-29 16:32:34 - setup_logging - scripts\setup_experiment.py:356 - INFO - Initializing DiscreteDQNAgent...
2025-04-29 16:32:34 - discrete_dqn_agent - models\agents\discrete_dqn_agent.py:209 - INFO - Created 21 action bins for each asset
2025-04-29 16:32:34 - discrete_dqn_agent - models\agents\discrete_dqn_agent.py:210 - INFO - Action bins for first asset: [-100.  -90.  -80.  -70.  -60.  -50.  -40.  -30.  -20.  -10.    0.   10.
   20.   30.   40.   50.   60.   70.   80.   90.  100.]
2025-04-29 16:32:35 - discrete_dqn_agent - models\agents\discrete_dqn_agent.py:67 - INFO - DiscreteDQN Network architecture: DiscreteDQNNetwork(
  (activation): ReLU()
  (layers): ModuleList(
    (0): Linear(in_features=4091, out_features=256, bias=True)
    (1): Linear(in_features=256, out_features=128, bias=True)
    (2): Dropout(p=0.1, inplace=False)
    (3): ReLU()
    (4): Linear(in_features=128, out_features=64, bias=True)
    (5): Dropout(p=0.1, inplace=False)
    (6): ReLU()
  )
  (output_layer): Linear(in_features=64, out_features=609, bias=True)
)
2025-04-29 16:32:35 - discrete_dqn_agent - models\agents\discrete_dqn_agent.py:67 - INFO - DiscreteDQN Network architecture: DiscreteDQNNetwork(
  (activation): ReLU()
  (layers): ModuleList(
    (0): Linear(in_features=4091, out_features=256, bias=True)
    (1): Linear(in_features=256, out_features=128, bias=True)
    (2): Dropout(p=0.1, inplace=False)
    (3): ReLU()
    (4): Linear(in_features=128, out_features=64, bias=True)
    (5): Dropout(p=0.1, inplace=False)
    (6): ReLU()
  )
  (output_layer): Linear(in_features=64, out_features=609, bias=True)
)
2025-04-29 16:32:36 - setup_logging - scripts\setup_experiment.py:477 - INFO - Setting up experiment manager...
2025-04-29 16:32:36 - experiment_discreteDQN - models\experiment_manager.py:197 - INFO - Saved experiment configuration to experiments\discreteDQN\config
2025-04-29 16:32:36 - experiment_discreteDQN - models\experiment_manager.py:238 - INFO - Saved data information to experiments\discreteDQN\data
2025-04-29 16:32:36 - experiment_discreteDQN - models\experiment_manager.py:152 - INFO - Initialized experiment: discreteDQN
2025-04-29 16:32:36 - setup_logging - scripts\setup_experiment.py:496 - INFO - Saving experiment manager for later training...
2025-04-29 16:32:36 - setup_logging - scripts\setup_experiment.py:496 - INFO - Saving experiment manager for later training...
2025-04-29 16:32:36 - setup_logging - scripts\setup_experiment.py:500 - INFO - Experiment setup completed: discreteDQN
2025-04-29 16:32:36 - setup_logging - scripts\setup_experiment.py:500 - INFO - Experiment setup completed: discreteDQN
2025-04-29 16:32:36 - setup_logging - scripts\setup_experiment.py:501 - INFO - All required files have been saved to experiments\discreteDQN
2025-04-29 16:32:36 - setup_logging - scripts\setup_experiment.py:501 - INFO - All required files have been saved to experiments\discreteDQN
2025-04-29 16:32:36 - setup_logging - scripts\setup_experiment.py:502 - INFO - The experiment is ready to be trained with:
2025-04-29 16:32:36 - setup_logging - scripts\setup_experiment.py:502 - INFO - The experiment is ready to be trained with:
2025-04-29 16:32:36 - setup_logging - scripts\setup_experiment.py:503 - INFO -   python -m scripts.train_experiment --experiment-name discreteDQN
2025-04-29 16:32:36 - setup_logging - scripts\setup_experiment.py:503 - INFO -   python -m scripts.train_experiment --experiment-name discreteDQN
2025-04-29 16:32:36 - setup_logging - scripts\setup_experiment.py:504 - INFO - To continue training from a checkpoint later, use:
2025-04-29 16:32:36 - setup_logging - scripts\setup_experiment.py:504 - INFO - To continue training from a checkpoint later, use:
2025-04-29 16:32:36 - setup_logging - scripts\setup_experiment.py:505 - INFO -   python -m scripts.continue_experiment --experiment-name discreteDQN
2025-04-29 16:32:36 - setup_logging - scripts\setup_experiment.py:505 - INFO -   python -m scripts.continue_experiment --experiment-name discreteDQN
